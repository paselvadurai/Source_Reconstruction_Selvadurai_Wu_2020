\documentclass[preprint,3p, 11pt,authoryear]{elsarticle}


\usepackage{graphicx}
\graphicspath{{./Graphic/}}
\usepackage{array}
\usepackage{amssymb} % various useful mathematical symbols
\usepackage{gensymb} % for `degree' sign
\usepackage{amsthm}  % extended theorem environments
\usepackage{lineno}   % for line numbers
\usepackage{tabularx} % for adjustable table width
\usepackage[hidelinks]{hyperref}  % for hyperlinks
\usepackage{amsmath}
\newtheorem{property}{Property}[section]
\usepackage{soul}
\usepackage{epsfig}
\usepackage{tabularx}
\usepackage{multirow} 
\usepackage{setspace}
\usepackage{adjustbox}
\usepackage{xcolor}
\usepackage[utf8]{inputenc}

\journal{Nondestructive Testing and Evaluation}

\begin{document}

\begin{frontmatter}



\title{A methodology for calculating active source-time functions from broadband piezoelectric sensors in the laboratory}

 \author[1]{Paul A. Selvadurai \corref{cor1}}
 \ead{paul.selvadurai@sed.ethz.ch}
\author[2]{Rui Wu}
\author[3]{Claudio Madonna}




\cortext[cor1]{Corresponding author, Post-Doctoral fellow}
\address[1]{Swiss Seismological Service, ETH Zurich, Zurich, Switzerland}
\address[2]{Engineering Geology Group, ETH Zurich, Zurich, Switzerland}
\address[3]{Department of Earth Sciences, ETH Zurich, Zurich, Switzerland}



\begin{abstract}

\end{abstract}

\begin{keyword}
Acoustic emissions, absolutely calibrated sensors, active source time function, empirical Green's functions
\end{keyword}
\end{frontmatter}

\doublespacing
\linenumbers
\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
\label{int}



\section{Experimental facilities}
\subsection{General}

\begin{figure}[ht]
     	\centering
\includegraphics[scale= 1.0]{FIG1.pdf} 
\caption{\textbf{(a)}  }
	\label{fig1} 
\end{figure}

\begin{figure}[ht]
     	\centering
\includegraphics[scale= 1.0]{FIG2.pdf} 
\caption{\textbf{(a)}  }
	\label{fig2} 
\end{figure}

\subsection{Material properties}














\subsection{Elsys Instruments High-voltage Multiplexer}
***need information on \textbf{Piezosystem Jena HVP1000/100MODext.} from Roman Bertschi***



\section{Theory}
\label{theo}
We review the methodology that will model the forces produced by an active source piezoelectric transducer.  This methodology takes advantage of the theory surrounding elastodynamic wave propagation in an elastic medium.  We build on the recent studies of signal analysis and instrument calibration by \citet{McLaksey2012} continuing this analysis using Green's function formalization \citep{Aki2002, Johnson1974}. We assume that wave propagation can be adequately described by convolution with the Green's function and that each component in our analysis can be modeled as a linear-time invariant system.  We are assuming that changes in the sensor and source behavior and material properties are unaffected over time.  We assume point representations of both the sensor and source location. This so-called ``aperture'' effect is minimized by using the point contact conical PZT crystal but some deviations might be incurred.

Using the classical theory describing dynamic elasticity \citep{Aki2002}, we can use Green's functions to relate the displacement $u$ at a known location $\mathbf{x}$ and time $t$ to a force $f$ at another point $\mathbf{\xi}$ and time $\tau$, which is given as the convolution of the force with the Green's function

\begin{equation}
\label{eq1}
           u_{k}\left( \mathbf{x}, t \right)  =  
            f_{j}\left( \mathbf{\xi}, \tau \right) \ast 
            g_{kj}\left( \mathbf{x}, t;\mathbf{\xi}, \tau \right).
\end{equation}

\noindent We note that $\ast$ represents convolution in the time domain, $f$ is the force acting in the $j$ direction at location $\mathbf{\xi}$ and $g_{kj}\left( \mathbf{x}, t;\mathbf{\xi}, \tau \right)$ is the elastodynamic Green's function describing the displacement $u$ in the direction $k$ at location $\mathbf{x}$.  The true Green's function describes the displacement at time $t$ and location $\mathbf{x}$ for the unit impulse force at location $\mathbf{\xi}$ at the delayed time $\tau$. 

Piezoelectric transducers measure a voltage caused by the compression of the lead zirconate titanate (PZT) crystal in the surface normal direction $s\left( \mathbf{x}, t \right)$. We can relate the true surface displacement $u_{k}$ to voltage measurement $s$ using the instrument response, which is given as

    \begin{equation}
    \label{eq2}
        s\left( \mathbf{x}, t \right) =
            u_{k}\left( \mathbf{x}, t \right) \ast i_{k}\left(t \right).
    \end{equation}

\noindent Combining \eqref{eq1} and \eqref{eq2}, we can represent the measured voltage to the forces which produced them:

    \begin{equation}
    \label{eq3}
        s\left( \mathbf{x}, t \right) =
            u_{k}\left( \mathbf{x}, t \right) \ast i_{k}\left(t \right) =  
                f_{j}\left( \mathbf{\xi}, \tau \right) \ast 
                g_{kj}\left( \mathbf{x}, t;\mathbf{\xi}, \tau \right) \ast i_{k}\left( t \right).
    \end{equation}

\noindent We can also use this formulation to relate the measured signals to a set of self-equilibrating forces or moments $m_{jp}$ \citep{Aki2002}. Displacements in the body are related to the spatial derivative of the elastodynamic Green's function $g_{kj,p}$.  While this is more similar to sources buried within a specimen and may be more representative of an earthquake source, this is not the focus of this study.  In this study, all sources are produced on the surface of the specimen, which justifies the use of only equation \eqref{eq2}.

Our study aims at determining the nature of the source produced that occurs we use the PZT crystal as active source. WE first decompose the source into two parts as shown here:

\begin{equation}
    \label{eq4}
    f_{j}\left( \mathbf{\xi}, \tau \right) = f^{*}_{j}\left( \mathbf{\xi}, \tau \right)  \ast \kappa \left( \tau \right),
\end{equation}

\noindent where $f^{*}_{j}$ is the normalized force-time function that has units (N) and a general shape to that follows the electro-mechanical behavior of the coupled high-voltage discharge and sensor systems.  A unitless scaling factor $\kappa$ will be used to scale the normalized force time-function $f^{*}$ to the true force-time function $f$ and likely varies with the time as the electrical pulse is applied to the active source.

We use properties of the Fourier transform \citep{Bracewell1986} to help deconvolve equations \eqref{eq3} and \eqref{eq4}.  In the frequency domain, convolution and deconvolution simply becomes multiplication and division. This allows us to isolate the components of interest we wish to quantify for our analysis. An example of the instrument response in the frequency domain $I_{w}$ simplifies to:

\begin{equation}
    \label{eq5}
        I_{k}\left(\omega \right) = 
        S\left( \mathbf{x}, \omega \right) \cdot \left[ F_{j}\left( \mathbf{\xi}, \hat{\omega} \right) \cdot G_{kj}\left( \mathbf{x}, \omega; \mathbf{\xi}, \hat{\omega} \right)\right]^{-1} .
\end{equation}

\noindent where $I_{k}$, $S$, $F_{j}$ and $G_{kj}$ are calculated from the temporal Fourier transforms of the $i_{k}$, $s$, $f_{j}$ and $g_{kj}$, respectively.  As we will see in Section \ref{XXX}, instrument responses was calculated for the sensor array shown in Figure \ref{fig1}, where a controlled force-time function were applied at the central location by dropping small steel balls of different diameters onto the surface from a known height. According to Hertzian contact theory, it is possible to assume a source time function that is a function of the material properties of the ball and steel platen ($E, \nu, \rho$), the radius of ball, and the drop height. This method has been popularized over the recent years due to a highly reliable and repeatable force-time function $f$ produced from ball impact and the ability to absolutely calibrate the acoustic emission sensors over a wide spectral range \citep{McLaskey2010, McLaskey2012, McLaskey2015}.

We will use the known instrument response to better understand the source produced from the active PZT transducer.  We can rearrange equation \eqref{eq5} to obtain the true force in the frequency domain:

\begin{equation}
    \label{eq6}
\begin{split}
F_{j}\left( \mathbf{\xi}, \hat{\omega} \right) & = 
        S\left( \mathbf{x}, \omega \right) \cdot \left[ I_{k}\left(\omega \right) \cdot G_{kj}\left( \mathbf{x}, \omega; \mathbf{\xi}, \hat{\omega} \right)\right]^{-1}, \\
\end{split}
\end{equation}

\noindent where by combing the Fourier transform of equation \eqref{eq4} we obtain an expression for the normalized force-time function,

\begin{equation}
    \label{eq7}
\begin{split}
F^{*}_{j}\left( \mathbf{\xi}, \hat{\omega} \right) & = 
        S\left( \mathbf{x}, \omega \right) \cdot \left[ K\left(\hat{\omega}\right) \cdot I_{k}\left(\omega \right) \cdot G_{kj}\left( \mathbf{x}, \omega; \mathbf{\xi}, \hat{\omega} \right)\right]^{-1}.\\     
\end{split}
\end{equation}

\noindent To solve the features about $F^{*}_{j}$, we will need to \textit{a priori} knowledge of sensors instrument response, also needed will be signal measurements $S$ and the true Green's function $G_{kj}$ but we will still not know the frequency-dependent scaling function $K(\hat{\omega})$ -- a primary calculation that is required to obtain the true force-time function produced by the active PZT transducer.

\section{Results}
\label{results}

In Figure \ref{fig3}(a) we show measurements on all passive sensors PZT sensors depicted in Figure \ref{fig1}(b).  Waveforms have been color coded following Figure \ref{fig1}(b) to show measurements taken at similar epicentral distances. These waveform we produced by actively exciting the source sensor located at the top central location of the steel platen. For our analysis, we only the first 50 $\mu$s of signal since we do not want to pollute the data with reflections from the boundary of the platen.  This allows us to analyze the wave using the approximation that the plate is in fact semi-infinite. Under this assumption we are able to solve for the Green's functions using the generalized ray theory code provided by \citet{Hsu1985} and modified for MATLAB by \citet{McLaskey2012}.  Figure \ref{fig3}(b) shows the empirical Green's functions (EGF) at a give epicentral location from the source. We call this the empirical Green's function since it is a numerical approximation of the true Green's function that is the resulting ground displacements $u$ at point $\mathbf{x}$ from a unit impulse function $\delta_{j}(\mathbf{\xi}, \tau)$. In Figure \ref{fig3}(b) we also show the wave phase arrivals (P, S, PPP, PPPPP) for the numerical models.

\begin{figure}[ht]
     	\centering
\includegraphics[scale= 1.0]{FIG3.pdf} 
\caption{\textbf{(a)} Measurements on from passive PZT transducers from a source produced from the active sensor. The color scheme represents sensors at the different epicentral locations shown in Figure \ref{fig1}(b).  \textbf{(b)} Green's function solutions using generalized ray theory for a semi-infinite elastic, homogeneous steel platen at different epicentral locations.  The empirical Green's function (EGF) is equal to the true Green's function represents the displacements produced from the unit impulse force $\delta_{j}(\tau)$. We see the various phase arrival predicted from the model.}
	\label{fig3} 
\end{figure}

Figure \ref{fig4} compares the theoretical Green's function $g_{kj}$ to the measured signals $s$.  We show the sensors A1 (red), A2 (yellow), A3 (green) and A4 (blue) from the epicentral distances of 0 mm, 23 mm, 46 mm and 69 mm, respectively. We see that the sensors appear to capture the multiple phase arrivals and this is believed to be due to the conical nature of the PZT crystal and its ability to capture wave arrivals at high azimuthal incident angles \citep{Selvadurai2019}. Results in Figure \ref{fig4} are representative of the measurements across all 13 passive sensors.

\begin{figure}[ht]
     	\centering
\includegraphics[scale= 0.90]{FIG4.pdf} 
\caption{Comparison of measurements on sensors A1, A2, A3 and A4 to the emipircal Green's functions calculated using generalized ray theory. The KRNBB sensor perform well and capture the wide range of wave phase arrivals.}
	\label{fig4} 
\end{figure}

To best show the approach we take to solve for the force time function produced by the active source, we focus on the measurements taken from sensors A3 at epicentral distance $x$ = 46 mm. Figure \ref{fig5}(a) shows the measurements and EGFs.  We focus on detail B, which looks at the first arrival P wave.  In Figure \ref{fig5}(b) this is shown in more detail with the sensors (green trace) and EGF (black trace) clearly visible.  Since we know that, in the time domain, the signal produced on the sensors the force-time function are convolved with the associated Green's function, the shape of the specific wave with be representative of the source. The blue curve in Figure \ref{fig5}(b) is a best-guess approximation of the source and will be use to estimate the general normalized force-time function $f^{*}_{j}$ from equation \eqref{eq4}.

\begin{figure}[ht]
     	\centering
\includegraphics[scale= 0.85]{FIG5.pdf} 
\caption{\textbf{(a)} Measurements from sensor A3 (green line) from the active source compared to the EGFs at the same place from the model.  Detail B looks more closely at the first-arrival P wave. \textbf{(b)} Shows the general shape of the P wave (green line) versus the location of the expected P wave arrival (black line) form the Green's function solution.  From the convolutional nature of the wave propagation problem (equation \eqref{eq1}) we can estimate the general shape of the normalized force-time function $f^{*}_{j}$ shown as the blue line.}
	\label{fig5} 
\end{figure}

\textbf{**Use Christensen (1988) to better define the force-time function**} We created the normalized force-time function based on characteristic of the first arrival P wave.  In Figure \ref{fig5}(c) we show the methodology for generating $f^{*}_{j}$.  We based this on the technical specifications of the high-voltage pulsing unit described in Section \ref{XXX}. In this experiment we applied a 100V pulse, which translates into a positive pulse, followed by a delay, then a negative pulse.  We approximated this behavior using piecewise discontinuous step functions (red curve) that was convolved with a 0.6 $\mu$s triangle function to smoothen the step function. This produced the blue curve which matched the general shape of the P wave arrival in Figure \ref{fig5}(c).  We will use this as a forward model to approximate the source-time from the active PZT source. We clearly see that the normalized force-time function varies from [-1,1], which is appropriate for our definition of $f^{*}$ in Section \ref{XXX}.

\begin{figure}[ht]
     	\centering
\includegraphics[scale= 0.9]{FIG5b.pdf} 
\caption{\textbf{(a)}  }
	\label{fig6} 
\end{figure}

To solve for the scaling function $K(\hat{\omega})$ we need to know the instrument response function $i(t)$. For this study, we use the results from \citet{Wu2020}. They performed multiple ball drops to create known force-time functions at the same location as the active sensors. The same sensors were used in their study and a series of different ball sizes where used (diameters = 0.3 mm, .....to 1.5 mm).  \citet{Wu2020} modeled long times to also capture how the sensors responded to frequencies as low as $f$ =1 kHz, following the methodology by \citet{Wu2018}.  Figure \ref{fig6}(a) shows the full instrument response function for each sensor in the Fourier domain (see equation \ref{eq5}).  Figure \ref{fig6}(b) focuses only on the results for frequencies between $f$ = 100 kHz to 1000 kHz, which is more important to our understanding of the true force-time function in our case.  


\begin{figure}[ht]
     	\centering
\includegraphics[scale= 0.9]{FIG6.pdf} 
\caption{\textbf{(a)}  }
	\label{fig6} 
\end{figure}


\begin{figure}[ht]
     	\centering
\includegraphics[scale= 1]{FIG7.pdf} 
\caption{\textbf{(a)}  }
	\label{fig7} 
\end{figure}


\begin{figure}[ht]
     	\centering
\includegraphics[scale= 1]{FIG8.pdf} 
\caption{\textbf{(a)}  }
	\label{fig8} 
\end{figure}


\begin{figure}[ht]
     	\centering
\includegraphics[scale= 1]{FIG9.pdf} 
\caption{\textbf{(a)}  }
	\label{fig9} 
\end{figure}

\begin{figure}[ht]
     	\centering
\includegraphics[scale= 1]{FIG10.pdf} 
\caption{\textbf{(a)}  }
	\label{fig10} 
\end{figure}




\clearpage

\section*{Acknowledgement}
T. M\"orgeli
 

\bibliographystyle{elsarticle-harv} 
\bibliography{Source_reconstruction}

\end{document}
\endinput
